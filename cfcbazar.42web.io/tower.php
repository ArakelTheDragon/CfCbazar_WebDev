<?php// tower.php ‚Äî Public Token Tower Game with Simulated Cash, Visit Tracking, and SEOini_set('display_errors', 1);error_reporting(E_ALL);require __DIR__ . '/../config.php'; // defines $conn// Visit tracking$uri  = parse_url($_SERVER['REQUEST_URI'], PHP_URL_PATH);$path = ($uri === '/' ? '/index.php' : $uri);$upd = $conn->prepare("UPDATE pages SET visits = visits + 1, updated_at = NOW() WHERE path = ?");if ($upd) {  $upd->bind_param('s', $path);  $upd->execute();  if ($upd->affected_rows === 0) {    $slug  = ltrim($path, '/');    $slug  = $slug === '' ? 'index' : $slug;    $title = 'Token Tower';    $ins = $conn->prepare("      INSERT INTO pages (title, slug, path, visits, created_at, updated_at)      VALUES (?, ?, ?, 1, NOW(), NOW())    ");    if ($ins) {      $ins->bind_param('sss', $title, $slug, $path);      $ins->execute();      $ins->close();    }  }  $upd->close();}?><!DOCTYPE html><html lang="en"><head>  <meta charset="UTF-8" />  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />  <title>üèóÔ∏è Token Tower | CfCbazar</title>  <meta name="description" content="Play Token Tower, a fast-paced stacking game by CfCbazar. Drop blocks, build your tower, and earn simulated cash. No login required!" />  <meta name="keywords" content="tower game, stacking game, CfCbazar, arcade, free game, no login, simulated cash" />  <meta name="author" content="CfCbazar" />  <meta name="robots" content="index, follow" />  <!-- Open Graph -->  <meta property="og:title" content="üèóÔ∏è Token Tower | CfCbazar" />  <meta property="og:description" content="Stack blocks and build your tower in CfCbazar's free arcade game. No login required!" />  <meta property="og:type" content="website" />  <meta property="og:url" content="https://cfcbazar.ct.ws/tower.php" />  <meta property="og:image" content="https://cfcbazar.ct.ws/assets/tower-preview.png" />  <!-- Twitter Card -->  <meta name="twitter:card" content="summary_large_image" />  <meta name="twitter:title" content="üèóÔ∏è Token Tower | CfCbazar" />  <meta name="twitter:description" content="Play Token Tower and earn simulated cash. Stack blocks and climb high!" />  <meta name="twitter:image" content="https://cfcbazar.ct.ws/assets/tower-preview.png" />  <style>    html, body {      margin: 0; padding: 0;      font-family: sans-serif;      background: #1a1a1a;      color: white;      display: flex; flex-direction: column;      align-items: center;    }    #hud {      width: 90vw;      display: flex; justify-content: space-between;      margin-top: 1vh; font-size: 5vw;    }    #balance { font-size: 4vw; margin-top: 0.5vh; }    #game {      position: relative;      width: 90vw; height: 80vh;      background: #111;      margin-top: 1vh;      overflow: hidden;      border: 3px solid #333;    }    .block {      position: absolute;      height: 5vh;      background: #32cd32;      left: 0;    }    button {      margin-top: 1vh;      font-size: 5vw;      padding: 1vh 4vw;      background: #444; color: white;      border: none;      border-radius: 10px;    }    button:active { background: #666; }    #message {      position: absolute;      top: 50%; left: 50%;      transform: translate(-50%, -50%);      text-align: center;      font-size: 6vw;      display: none;    }  </style></head><body>  <div id="hud">    <div>Score: <span id="score">0</span></div>    <div>Time: <span id="timer">30</span>s</div>  </div>  <div id="balance">Cash: $<span id="wtBalance">1.000</span></div>  <div id="game">    <div id="message"></div>  </div>  <button onclick="dropBlock()">DROP</button>  <script>    const game = document.getElementById('game');    const scoreEl = document.getElementById('score');    const timerEl = document.getElementById('timer');    const msgEl = document.getElementById('message');    const balEl = document.getElementById('wtBalance');    let tower = [], current, direction, speed, level = 0, gameOver = false;    let timeLeft = 30, gameInterval, timerInterval;    let cash = 1.000;    function init() {      gameOver = false;      level = 0;      timeLeft = 30;      tower = [];      game.innerHTML = ''; game.appendChild(msgEl);      scoreEl.textContent = 0;      timerEl.textContent = timeLeft;      msgEl.style.display = 'none';      spawnBlock();      gameInterval = requestAnimationFrame(animate);      timerInterval = setInterval(() => {        timeLeft--;        timerEl.textContent = timeLeft;        if (timeLeft <= 0) endGame();      }, 1000);    }    function spawnBlock() {      const width = level === 0 ? game.clientWidth : tower[level - 1].offsetWidth;      const y = game.clientHeight - (level + 1) * 5 * game.clientHeight / 100;      current = document.createElement('div');      current.className = 'block';      current.style.width = width + 'px';      current.style.top = y + 'px';      current.style.left = '0px';      game.appendChild(current);      direction = 1;      speed = 2 + level / 10;    }    function animate() {      if (gameOver) return;      const maxX = game.clientWidth - current.offsetWidth;      let x = parseFloat(current.style.left) || 0;      x += direction * speed;      if (x < 0) { x = 0; direction = 1; }      if (x > maxX) { x = maxX; direction = -1; }      current.style.left = x + 'px';      for (const b of tower) {        const ty = parseFloat(b.style.top);        b.style.top = (ty + speed * 0.15) + 'px';      }      current.style.top = (parseFloat(current.style.top) + speed * 0.15) + 'px';      gameInterval = requestAnimationFrame(animate);    }    function dropBlock() {      if (gameOver) return init();      cash -= 0.001;      balEl.textContent = cash.toFixed(3);      const prev = tower[level - 1];      const curr = current;      const cx = curr.offsetLeft, cw = curr.offsetWidth;      if (level === 0) {        tower.push(curr);      } else {        const px = prev.offsetLeft, pw = prev.offsetWidth;        const overlapStart = Math.max(px, cx);        const overlapEnd = Math.min(px + pw, cx + cw);        const overlapWidth = overlapEnd - overlapStart;        if (overlapWidth <= 0) {          endGame();          return;        }        curr.style.left = overlapStart + 'px';        curr.style.width = overlapWidth + 'px';        tower.push(curr);      }      level++;      scoreEl.textContent = level;      spawnBlock();    }    function endGame() {      gameOver = true;      cancelAnimationFrame(gameInterval);      clearInterval(timerInterval);      if (level >= 150) {        cash += 1;        balEl.textContent = cash.toFixed(3);        msgEl.innerHTML = `üéâ You built a tower of ${level} blocks! +$1.00`;      } else {        msgEl.innerHTML = `üèÅ Game Over! Final score: ${level}`;      }      msgEl.style.display = 'block';    }    window.onload = init;  </script></body></html>